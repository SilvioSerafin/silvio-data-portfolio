USE BellaBeat; GO WITH user_days AS (SELECT Id, AVG(CAST(TotalSteps AS float)) AS avg_steps FROM dbo.v_daily_activity GROUP BY Id) SELECT CASE WHEN avg_steps >= 10000 THEN 'High movers (10k+)' WHEN avg_steps BETWEEN 5000 AND 9999 THEN 'Moderate movers (5k–10k)' ELSE 'Low movers (<5k)' END AS segment, COUNT(*) AS users FROM user_days GROUP BY CASE WHEN avg_steps >= 10000 THEN 'High movers (10k+)' WHEN avg_steps BETWEEN 5000 AND 9999 THEN 'Moderate movers (5k–10k)' ELSE 'Low movers (<5k)' END ORDER BY users DESC;