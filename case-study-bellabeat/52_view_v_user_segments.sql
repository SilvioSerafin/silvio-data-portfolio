USE BellaBeat; GO CREATE OR ALTER VIEW dbo.v_user_segments AS SELECT u.Id, CASE WHEN u.avg_steps >= 10000 THEN 'High movers (10k+)' WHEN u.avg_steps BETWEEN 5000 AND 9999 THEN 'Moderate movers (5kâ€“10k)' ELSE 'Low movers (<5k)' END AS movement_segment FROM (SELECT Id, AVG(CAST(TotalSteps AS float)) AS avg_steps FROM dbo.v_daily_activity GROUP BY Id) AS u;