USE BellaBeat; GO CREATE OR ALTER VIEW dbo.v_dim_date AS WITH bounds AS (SELECT MIN(activity_date) AS dmin, MAX(activity_date) AS dmax FROM dbo.v_daily_activity), cal AS (SELECT dmin AS d FROM bounds UNION ALL SELECT DATEADD(DAY, 1, c.d) FROM cal c CROSS JOIN bounds b WHERE c.d < b.dmax) SELECT d, DATENAME(WEEKDAY, d) AS weekday_name, DATEPART(WEEKDAY, d) AS weekday_num, DATEPART(MONTH, d) AS month_num FROM cal OPTION (MAXRECURSION 0);