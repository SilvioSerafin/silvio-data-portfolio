USE BellaBeat; GO CREATE OR ALTER VIEW dbo.v_daily_activity AS WITH ranked AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY Id, ActivityDate ORDER BY ActivityDate) AS rn FROM dbo.dailyActivity_merged2) SELECT Id, CAST(ActivityDate AS date) AS activity_date, TotalSteps, TotalDistance, VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes, Calories FROM ranked WHERE rn = 1;