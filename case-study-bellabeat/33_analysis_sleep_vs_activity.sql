USE BellaBeat; GO WITH ds AS (SELECT a.Id, a.activity_date, a.TotalSteps, a.Calories, s.TotalMinutesAsleep, s.TotalTimeInBed FROM dbo.v_daily_activity a LEFT JOIN dbo.v_sleep s ON a.Id = s.Id AND a.activity_date = s.sleep_date) SELECT CONVERT(decimal(10,1), AVG(CAST(TotalMinutesAsleep AS float)) / 60.0) AS avg_sleep_hours, CONVERT(decimal(10,1), AVG(CAST(TotalTimeInBed AS float)) / 60.0) AS avg_time_in_bed_hours, CONVERT(decimal(10,1), AVG(CAST(TotalSteps AS float))) AS avg_steps, CONVERT(decimal(10,1), AVG(CAST(Calories AS float))) AS avg_cal FROM ds;